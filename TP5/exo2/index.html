<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des utilisateurs</title>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 { text-align: center; }
        #addUserForm { margin-bottom: 20px; }
        .form-group { margin-bottom: 10px; }
        label { display: inline-block; width: 150px; }
        input[type="text"], input[type="date"] { width: 200px; }
        button { cursor: pointer; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Gestion des utilisateurs</h1>
        
        <form id="addUserForm">
            <div class="form-group">
                <label for="nom">Nom:</label>
                <input type="text" id="nom" required>
            </div>
            <div class="form-group">
                <label for="prenom">Prénom:</label>
                <input type="text" id="prenom" required>
            </div>
            <div class="form-group">
                <label for="dateNaissance">Date de naissance:</label>
                <input type="date" id="dateNaissance">
            </div>
            <div class="form-group">
                <label for="aimeCoursWeb">Aime le cours Web:</label>
                <input type="checkbox" id="aimeCoursWeb">
            </div>
            <div class="form-group">
                <label for="remarques">Remarques:</label>
                <input type="text" id="remarques">
            </div>
            <button type="submit">Ajouter utilisateur</button>
        </form>

        <table id="usersTable" class="display">
            <thead>
                <tr>
                    <th>Nom</th>
                    <th>Prénom</th>
                    <th>Date de naissance</th>
                    <th>Aime le cours Web</th>
                    <th>Remarques</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <script>
        $(document).ready(function() {
            var table = $('#usersTable').DataTable({
                ajax: {
                    url: 'http://localhost/IDAW/TP4/exo5/xxx',
                    dataSrc: ''
                },
                columns: [
                    { data: 'nom' },
                    { data: 'prenom' },
                    { data: 'dateNaissance' },
                    { data: 'aimeCoursWeb' },
                    { data: 'remarques' },
                    {
                        data: null,
                        render: function(data, type, row) {
                            return '<button onclick="editUser(' + row.id + ')">Edit</button> ' +
                                   '<button onclick="deleteUser(' + row.id + ')">Delete</button>';
                        }
                    }
                ]
            });

            $('#addUserForm').submit(function(e) {
                e.preventDefault();
                var userData = {
                    nom: $('#nom').val(),
                    prenom: $('#prenom').val(),
                    dateNaissance: $('#dateNaissance').val(),
                    aimeCoursWeb: $('#aimeCoursWeb').is(':checked'),
                    remarques: $('#remarques').val()
                };

                $.ajax({
                    url: 'http://localhost/IDAW/TP4/exo5/xxx',
                    type: 'POST',
                    data: JSON.stringify(userData),
                    contentType: 'application/json',
                    success: function(response) {
                        alert('Utilisateur ajouté avec succès');
                        table.ajax.reload();
                        $('#addUserForm')[0].reset();
                    },
                    error: function(xhr, status, error) {
                        alert('Erreur lors de l\'ajout de l\'utilisateur: ' + error);
                    }
                });
            });

            function editUser(id) {
                // Implementer la logique d'édition ici
                console.log('Édition de l\'utilisateur avec ID:', id);
            }

            function deleteUser(id) {
                if (confirm('Êtes-vous sûr de vouloir supprimer cet utilisateur ?')) {
                    $.ajax({
                        url: 'http://localhost/IDAW/TP4/exo5/xxx/' + id,
                        type: 'DELETE',
                        success: function(response) {
                            alert('Utilisateur supprimé avec succès');
                            table.ajax.reload();
                        },
                        error: function(xhr, status, error) {
                            alert('Erreur lors de la suppression de l\'utilisateur: ' + error);
                        }
                    });
                }
            }

            window.editUser = editUser;
            window.deleteUser = deleteUser;
        });
    </script>
</body>
</html>